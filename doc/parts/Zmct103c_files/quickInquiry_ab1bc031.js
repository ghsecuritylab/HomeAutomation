document.domain=/[\w\-]+\.[\w\-]+$/.exec(window.location.hostname)[0];var hisLoginStatus=!1,senderInfo=null,resetFlag=!1;$(function(){$.ajax({type:"get",url:"http://www.made-in-china.com/inquiryabout.do?xcase\x3dgetCookieSendEmail",dataType:"jsonp",success:function(a){a&&a.senderMail&&(document.forms.inqueryForm.senderMail.value=a.senderMail)}});var a=$("#loginStatu").val();a&&0!=a&&(hisLoginStatus=!0);initQuickInquiry()});
function initQuickInquiry(){if($("#inqueryForm").length){var a=inquiryFormValidate();$("#inqueryForm").bind("submit",function(b){quickRequestFormLog();b.preventDefault();a.isValidate()&&($("#inquirySend").addClass("btn-disabled").attr("disabled","disabled"),senderInfo&&!hisLoginStatus?(senderInfo.show(),b=$(senderInfo.DOM.content[0]).find("iframe")[0].contentWindow,initDialog(hisLoginStatus,b,!1)):senderInfoDialog(hisLoginStatus),senderInfo&&senderInfo.lock(),senderInfo&&senderInfo.position("50%",
"33%"))})}}function quickRequestFormLog(){var a=$("#showRoomUrl").val().replace(".html","_1.html")+"\x26qkSendStep\x3dsecond";$.ajax({type:"get",url:a,dataType:"jsonp",success:function(a){}})}
function inquiryFormValidate(){function a(a,b){$(b).parent().find(".alert-wrong").remove();$(b).parent().append(h.replace("{Message}",a))}function b(){var b=!0;if(!/\S+/.test(f.value))return a("Please enter your email address.",f),!1;var d;d=f.value;if(/^[-\.\w]+@[-\.a-zA-Z0-9]+\.[-\.a-zA-Z0-9]+$/.test(d)){var c=d.split("@")[0];d=d.split("@")[1];if(!/^.*[A-Za-z0-9]+.*$/.test(c)||/(^\..*)|(.*\.$)/.test(c)||/(\.){2,}/.test(c))d=!1;else{var e=d.lastIndexOf("."),c=d.substr(0,e);d=d.substr(e+1);d=/(^[\.-].*)|(.*[\.-]$)/.test(c)||
/(\.){2,}/.test(c)||!/^[a-zA-Z]+$/.test(d)?!1:!0}}else d=!1;d||(a("Please enter a valid email address.",f),b=!1);return b}function g(){var b=!0;/\S+/.test(e.value)||(a("Please enter the content for your inquiry.",e),b=!1);if(20>e.value.length||4E3<e.value.length)a("Your inquiry content must be between 20 to 4000 characters.",e),b=!1;return b}var c=document.forms.inqueryForm,f=c.senderMail,e=c.content,h='\x3cdiv class\x3d"alert alert-wrong"\x3e\x3cdiv class\x3d"alert-con"\x3e{Message}\x3c/div\x3e\x3c/div\x3e';
$(f).bind("blur",function(c){b()?$(c.target).parent().find(".alert-wrong").remove():a()});$(e).bind("blur",function(b){g()?$(b.target).parent().find(".alert-wrong").remove():a()});return{isValidate:function(){var a=b(),c=g();return a&&c}}}
function senderInfoDialog(a,b){var g="display:none";$.browser.msie&&7>=parseInt($.browser.version)&&(g="visibility:hidden;");senderInfo=new art.dialog({fixed:!0,show:b?!1:!0,title:a?"":"Enter your contact to build trust with supplier(s)",duration:0,content:'\x3cdiv class\x3d"aui_loading" style\x3d"margin:60px auto; width:540px; height:55px; background:url(http://img.made-in-china.com/img/athena/loading-big.gif) no-repeat center center;"\x3e\x3c/div\x3e\x3ciframe src\x3d"http://www.made-in-china.com/sendInquiry/showQuickForm/" frameborder\x3d"0" style\x3d"'+g+
'"\x3e\x3c/iframe\x3e',init:function(){var c=this;resetFlag=!1;$(this.DOM.content[0]).find("iframe").bind("load",function(){initDialog(a,$(c.DOM.content[0]).find("iframe")[0].contentWindow,b)})},close:function(){asyncIsLogin(function(a){a&&a!==hisLoginStatus?window.location.reload():($("#inquirySend").removeClass("btn-disabled").removeAttr("disabled"),resetFlag&&($("#inquiryContent").val(""),senderInfo.close(),senderInfo=null))});if(!resetFlag)return senderInfo.hide(),!1}})}
function initDialog(a,b,g){var c=document.forms.inqueryForm.content.value,f=document.forms.inqueryForm.senderMail.value;b.loginClickHandle=function(){login&&login("\x26loginUserName\x3d"+f,function(a){senderInfoDialog(a);senderInfo&&senderInfo.lock();senderInfo&&senderInfo.position("50%","33%")});senderInfo.close();senderInfo=null;$("#inquirySend").removeClass("btn-disabled").removeAttr("disabled")};b.setForm&&b.setForm({senderMail:f,content:c,requestUrl:$("#showRoomUrl").val().replace(".html","_1.html")+
"\x26qkSendStep\x3dsecond"});b.setForm||(resetFlag=!0);if(senderInfo&&!a||!b.setForm)$(senderInfo.DOM.content[0]).find("iframe").css("visibility","visible"),$(senderInfo.DOM.content[0]).find("iframe").show(),$(senderInfo.DOM.content[0]).find(".aui_loading").remove(),resizeForm();a&&!g&&b&&b.autoSubmit&&b.autoSubmit();b.result&&senderInfo.title("")}
function resizeForm(){var a;senderInfo&&(a=$(senderInfo.DOM.content[0]).find("iframe")[0],$(a).css({width:a.contentWindow.document.body.clientWidth,height:a.contentWindow.document.body.clientHeight}));window.priceDialog&&(a=$(priceDialog.DOM.content[0]).find("iframe")[0],$(a).css({height:a.contentWindow.document.body.clientHeight}))};