var Preload=function(){var g=function(){},k=function(d){return Object.prototype.toString.call(d).match(/\w+/g)[1].toLowerCase()},c=function(d){if("string"!==typeof d)throw"param str is not a string";return d.replace(/^[\s\u00A0]+|[\s\u00A0]+$/g,"")},a=function(d,m,a){d||(d="#null");"string"===typeof d&&(this.url=d||"#null");m||(m=g);"function"===typeof m&&(this.success=m);a||(a=g);"function"===typeof m&&(this.error=a);this.times=0};a.prototype={valid:function(){this.url=c(this.url);return"string"===
typeof this.url&&"#null"!==this.url&&""!==this.url}};var e=function(d){return"string"===k(d)?new a(d):"object"===k(d)?new a(d.url,d.success,d.error):new a},r=function(d){var m=document.createElement("img");m.style.cssText="position:absolute; top:-9999px; left:-9999px;";var a=function(){"function"===typeof d.success&&d.success.call(this,d);this.onload=this.onerror=this.onabort=g;document.body.removeChild(this)},c=function(){"function"===typeof d.error&&d.error.call(this,d);this.onload=this.onerror=
this.onabort=g;document.body.removeChild(this)};m.src=d.url;document.body.appendChild(m);m.complete?a.call(m):(m.onload=a,m.onerror=m.onabort=c)},f=function(d,m){for(var a=0,c=d.length,b=-1;a<c;a++)if(d[a]===m){b=a;break}return b},n=function(d){var a=this._={};a.status=1;a.queue=[];a.thread=[];a.retry=[];a.fail=[];a.done=[];a.cfg={thread:4,retry:1};if(d){var c=parseInt(d.thread);c&&0<c&&(a.cfg.thread=c);(c=parseInt(d.retry))&&0<=c&&(a.cfg.retry=c)}var g=function(){switch(a.status){case 5:a.queue.splice(0,
a.queue.length);a.retry.splice(0,a.retry.length);break;case 1:case 2:case 3:if(a.thread.length<=a.cfg.thread){var b;a.retry.length&&[].push.apply(a.queue,a.retry.splice(0,a.retry.length));(b=a.queue.length&&a.queue.splice(0,1)[0])?(a.thread.push(b),r(b)):a.thread.length||(a.status=3)}}},b=function(b,a){var d=b.success,c=b.error;b.success=function(){d.apply(this,arguments);var c=f(a.thread,b);a.thread.splice(c,1);a.done.push(b);g()};b.error=function(){c.apply(this,arguments);var d=f(a.thread,b);a.thread.splice(d,
1);b.times<a.cfg.retry?(a.retry.push(b),b.times++):a.fail.push(b);g()};return b};a.ctrl={start:function(){a.status=2;for(var b=a.cfg.thread-a.thread.length;b--&&a.queue.length;)g()},pause:function(){a.status=4},stop:function(){a.status=5}};this.load=function(l){var d,c;if("array"===k(l))for(d=0;d<l.length;d++)c=e(l[d]),c.valid()&&(b(c,a),this._.queue.push(c));else c=e(l),c.valid()&&(b(c,a),this._.queue.push(c));this._.ctrl.start();return this}};n.prototype={isLoaded:function(a){a=c(a);for(var e=!1,
f=this._.done,g=0,b=f.length;g<b;g++)if(c(f[g].url)===a){e=!0;break}return e},isLoading:function(a){for(var c=!1,e=this._.thread,f=0,b=e.length;f<b;f++)if(e[f].url===a){c=!0;break}return c},isFailed:function(a){for(var c=!1,e=this._.fail,f=0,b=e.length;f<b;f++)if(e[f].url===a){c=!0;break}return c}};return n}.call(this),CSSRuleOperator=function(){var g=function(c){return c.replace(/(^|\s+)[A-Z]+/g,function(a){return a.toLowerCase()})},k=function(c){c||(c=document.createElement("style"),c.type="text/css",
document.getElementsByTagName("head")[0].appendChild(c));this.sheet=c.sheet||c.styleSheet||c;this.rules=this.sheet.cssRules||this.sheet.rules};k.prototype={get:function(c){var a,e=parseInt(c);if("number"===typeof e&&-1<e&&e<this.rules.length)a=this.rules[e];else if("string"===typeof c){c=g(c);var k;this.each(function(e,n){k=g(n.selectorText);if(k===c)return a=this.rules[e],!0})}return a?{selectorText:a.selectorText,cssText:a.cssText||a.selectorText+"{"+a.style.cssText+"}",style:this.split(a.cssText||
a.style.cssText)}:a},set:function(c,a,e,g){var f={selectorText:c,style:{}};if(g){f=this.get(c)||f;try{this.del(f.selectorText)}catch(k){}}"string"===typeof a&&(a=this.split(a));c=f.style;for(var d in a)c[d]=a[d];e=e||this.rules.length;e=e>=this.rules.length||0>e?this.rules.length:e;this.sheet.insertRule?this.sheet.insertRule(this.toCssText(f.selectorText,f.style),e):(e=e>this.rules.length?-1:e,this.sheet.addRule(f.selectorText,this.toRuleStr(f.style),e))},del:function(c){if(this.sheet.removeRule)return this.sheet.removeRule(c),
!0;var a=parseInt(c);if("number"===typeof a&&-1<a&&a<this.rules.length)this.sheet.deleteRule(a);else if("string"===typeof c){c=g(c);var e;this.each(function(a,f){e=g(f.selectorText);if(e===c)return this.sheet.deleteRule(a),!0})}},exist:function(c){c=g(c);var a,e;this.each(function(k,f){a=g(f.selectorText);if(a===c)return e=!0});return e},each:function(c){for(var a=0,e=this.rules.length,g;a<e&&!(g=c.call(this,a,this.rules[a]));a++);return this},split:function(c){var a={};c.replace(/([-a-zA-Z]+)\s*\:\s*([^;]+)/g,
function(c,g,f){a[g.toLowerCase()]=f});return a},toRuleStr:function(c){var a=[],e;for(e in c)a.push(e,":",c[e],";");return a.join("")},toCssText:function(c,a){var e=[c,"{"];e.push(this.toRuleStr(a));e.push("}");return e.join("")}};return k}.call(this),Magnifier=function(g,k,c){var a=function(){},e=function(){var b=k.createElement("style");b.type="text/css";k.getElementsByTagName("head")[0].appendChild(b);this.rule=new d.Rule(b)},r=function(){var b=["position:absolute; top:-",9999,"px; left:-",9999,
"px;"];if(d.browser.msie&&9>d.browser.version)b.push("background-color:",this.config.layer.bgColor,"\\9; filter:alpha(opacity\x3d",100*this.config.layer.alpha,")\\9;");else{var l=d.color.toRGB(this.config.layer.bgColor);b.push("background-color:rgba(",l.R,",",l.G,",",l.B,",",this.config.layer.alpha,");")}this.config.layer.bgImage&&(b.push("background-image:url('",this.config.layer.bgImage,"');"),d.browser.msie?b.push("filter:alpha(opacity\x3d",100*this.config.layer.opacity,");"):b.push("opacity:",
this.config.layer.opacity,";"));b.push("cursor:",this.config.layer.cursor,"; diplay:block; width:90px; height:60px;");this.rule.set(".magnifier_layer_"+this.uuid,b.join(""));b=["position:absolute; overflow:hidden; top:-",9999,"px; left:-",9999,"px;"];b.push("width:",this.config.detail.width,"px;");b.push("height:",this.config.detail.height,"px;");b.push("border:",this.config.detail.borderWidth,"px ",this.config.detail.borderStyle," ",this.config.detail.borderColor,";");b.push("background-color:",
this.config.detail.bgColor,";");b.push("opacity:",this.config.detail.opacity,"; filter:alpha(opacity\x3d",100*this.config.detail.opacity,");");this.rule.set(".magnifier_detail_"+this.uuid,b.join(""));b=["display:block; overflow:hidden; position:absolute; top:50%; left:50%;"];this.rule.set(".magnifier_loading_"+this.uuid,b.join(""));b=["display:block; overflow:hidden; position:absolute; top:50%; left:50%;"];this.rule.set(".magnifier_detailLayer_"+this.uuid,b.join(""));b=["display:block; margin:0 auto; position:relative;"];
this.rule.set(".magnifier_detailImg_"+this.uuid,b.join(""))};c=new Abstract({show:function(b,l,a){},hide:function(){},changeTarget:function(b){},dispose:function(){},turn:function(b){},showLayer:function(){},hideLayer:function(){},showDetailImg:function(){},hideDetailImg:function(){},showLoading:function(){},hideLoading:function(){},setDetailImageSrc:function(b){},changeDetail:function(b,l,a){}});var f=new Clazz(c,{inherit:Component,config:{layer:{bgColor:"#000",alpha:0.3,bgImage:"",opacity:1,cursor:"move"},
detail:{width:450,height:300,borderColor:"#ccc",borderWidth:1,borderStyle:"solid",bgColor:"#fff",opacity:1,offsetX:10,offsetY:0},target:null,detailImg:"",loading:""}},function(b){if(this===g)return new f(b);var l=this;this.setConfig(b);if(!this.config.target)throw"target is required";this.uuid=(new Date).valueOf()+""+d.random(0,1E3);e.call(this);r.call(this);this.loader=new d.Preload({thread:2,retry:1});this.__init();this.loader.load({url:this.config.loading,success:function(){l.elems.loading.src=
this.src;m.call(this,l.elems.loading)}})});f.readyState=!1;f.ready=function(b){"function"===typeof b&&(f.readyState?b():n.readyHandle.push(b))};var n=f._={};n.readyHandle=[];var d=f.tools={};d.random=function(b,l){return Math.floor((l-b)*Math.random()+b)};d.type=function(b){var l;l="undefined"===typeof b?"undefined":null===b?"null":Object.prototype.toString.call(b).match(/\w+/g)[1].toLowerCase();"number"===l&&isNaN(b)&&(l="nan");return l};d.search=function(b,l){for(var a=0,c=b.length,d=-1;a<c;a++)if(b[a]===
l){d=a;break}return d};d.color={RESULT:{RGB:"rgb",HEX:"hex",UNKNOWN:null},valid:function(b){var a=d.type(b),c=this.RESULT.UNKNOWN;"object"===a&&"R"in b&&0<=+b.R&&255>=+b.R&&"G"in b&&0<=+b.G&&255>=+b.G&&"B"in b&&0<=+b.B&&255>=+b.B?c=this.RESULT.RGB:"string"===a&&/^#?([0-9a-f]{3}|[0-9a-f]{6})$/i.test(b)&&(c=this.RESULT.HEX);return c},toHEX:function(b){var a="#";this.valid(b)===this.RESULT.RGB?(a+=parseInt(b.R).toString(16),a+=parseInt(b.G).toString(16),a+=parseInt(b.B).toString(16)):a="#000";return a},
toRGB:function(b){var a={R:0,G:0,B:0};this.valid(b)===this.RESULT.HEX&&(b=b.replace(/#/,"").toLowerCase(),3===b.length&&(b=b.replace(/([0-9a-f])/g,"$1$1")),b=b.match(/[0-9a-f]{2}/g),a.R=parseInt(b[0],16),a.G=parseInt(b[1],16),a.B=parseInt(b[2],16));return a}};d.getScript=function(b,l,c){var d=k.getElementsByTagName("head")[0],h=k.createElement("script");h.type="text/javascript";h.defer=!0;h.aysnc=!0;var e=function(){h.onreadystatechange=a;h.onload=a;h.onerror=a};h.src=b;d.appendChild(h);h.complete||
h.loaded||"complete"===h.readyState||"loaded"===h.readyState?e():(h.onreadystatechange=function(b){if("complete"===h.readyState||"loaded"===h.readyState)l.call(h,b||g.event),e()},h.onload=function(b){(l||a).call(h,b||g.event);e()},h.onerror=function(b){(c||a).call(h,b||g.event);e()})};d.require=function(){var b=[].slice.call(arguments),l=a;"function"===typeof b[b.length-1]&&(l=b.pop());if(b.length)for(var c=Array(b.length+1).join(0).split(""),e=0;e<b.length;e++)"string"===typeof b[e]&&d.getScript(b[e],
function(b){return function(){c[b]="1";-1===d.search(c,"0")&&l()}}(e));else l()};n.init=function(){for(var b;b=n.readyHandle.shift();)b()};d.pageXY=function(b){b=b.getBoundingClientRect();var a=g.scrollTop||k.documentElement&&k.documentElement.scrollTop||k.body.scrollTop||0,c=g.scrollLeft||k.documentElement&&k.documentElement.scrollLeft||k.body.scrollLeft||0,d=(k.documentElement||k.getElementsByTagName("html")[0]).getBoundingClientRect(),d={left:0>d.left?0:d.left,top:0>d.top?0:d.top};/msie\s*6/i.test(g.navigator.appVersion)&&
(d={left:d.left+2,top:d.top+2});return{left:b.left+c-d.left,top:b.top+a-d.top}};var m=function(b,a,c){b.width=this.width;b.height=this.height;var e=d.type(a),h=d.type(c);a="number"===e?-a+"px":"undefined"===e?-this.width/2+"px":a;c="number"===h?-c+"px":"undefined"===h?-this.height/2+"px":c;b.style.cssText+=";margin-top:"+c+"; margin-left:"+a+";";b.src=this.src},q={e:{clientX:0,clientY:0},_fix:function(b){if(this.loader.isLoaded(this.config.detailImg)){var a=this.elems.target,c=this.elems.layer,e=
this.elems.detailLayer,h=a.getBoundingClientRect(),f=parseInt(a.currentStyle?a.currentStyle.borderTopWidth:k.defaultView.getComputedStyle(a,null).borderTopWidth),f="nan"===d.type(f)?2:f,g=b.clientX-h.left-f,h=b.clientY-h.top-f;g>a.clientWidth-c.clientWidth/2?(g="auto",b=0):(g=g>c.clientWidth/2?g-c.clientWidth/2:0,b="auto");h>a.clientHeight-c.clientHeight/2?(h="auto",f=0):(h=h>c.clientHeight/2?h-c.clientHeight/2:0,f="auto");c.style.cssText+=";left:"+("auto"===g?g:g+"px")+"; top:"+("auto"===h?h:h+"px")+
"; right:"+("auto"===b?b:b+"px")+"; bottom:"+("auto"===f?f:f+"px")+";";a=a.clientWidth/e.clientWidth;e.style.cssText+=";left:"+("auto"===g?g:-g/a+"px")+"; top:"+("auto"===h?h:-h/a+"px")+"; right:"+("auto"===b?b:-b/a+"px")+"; bottom:"+("auto"===f?f:-f/a+"px")+";"}},timer:0,_enter:function(b,a,c){if(a.STATUS===p.OFF)a.hide();else if(b=c.detailImg)a.loader.isLoaded(b)?a.show(b):a.loader.isLoading()||(a.showLoading(),a.show(b))},_leave:function(b,a){a.hideLayer();a.hide()},_move:function(b,a){a.STATUS===
p.OFF?a.hide():q._fix.call(a,b)}},p=f.SWITCH_STATUS={OFF:0,ON:1};f.extend({showLayer:function(){},hideLayer:function(){this.elems.layer.style.cssText+=";left:-9999px; top:-9999px;"},showDetailImg:function(){this.elems.detailLayer.style.cssText+=";left:0; top:0;"},hideDetailImg:function(){this.elems.detailLayer.style.cssText+=";left:-9999px; top:-9999px;"},showLoading:function(){this.elems.loading.style.cssText+=";left:50%; top:50%;";this.fire("loading")},hideLoading:function(){this.elems.loading.style.cssText+=
";left:-9999px; top:-9999px;";this.fire("loaded")},setDetailImageSrc:function(b){"string"===d.type(b)&&(this.hideDetailImg(),this.config.detailImg=b,this.fire("setDetailImageSrc",{src:b}));return this},changeDetail:function(b,a,c){var e=this;if(b=b||this.config.detailImg){this.showLoading();this.hideDetailImg();this.config.detailImg=b;var f=d.type(a),g=d.type(c);a="number"===f?a:"undefined"===f?"auto":0;c="number"===g?c:g?"auto":0;this.loader.load({url:b,success:function(){var b=e.elems.layer,d=e.elems.detail,
f=e.elems.target,g=e.elems.detailLayer,h=e.elems.detailImg;m.call(this,h,a,c);f.clientWidth*this.height>f.clientHeight*this.width?(g.style.height=this.height+"px",g.style.width=this.height*f.clientWidth/f.clientHeight+"px",h.style.marginTop="0px"):(g.style.width=this.width+"px",g.style.height=this.width*f.clientHeight/f.clientWidth+"px",h.style.marginTop=Math.abs((g.clientHeight-this.height)/2)+"px");b.style.cssText+=";width:"+f.clientWidth*d.clientWidth/g.clientWidth+"px; height:"+f.clientHeight*
d.clientHeight/g.clientHeight+"px;";e.showDetailImg();e.hideLoading()}});this.fire("changeDetail",{src:b,x:a,y:c});return this}},show:function(b,a,c){if(this.STATUS===p.OFF)this.hide();else{"string"===d.type(b)&&this.changeDetail(b);var e=d.pageXY(this.elems.target);a="number"===d.type(a)?a:this.config.detail.offsetX;c="number"===d.type(c)?c:this.config.detail.offsetY;this.elems.detail.style.cssText+=";left:"+(e.left+this.elems.target.offsetWidth+a)+"px; top:"+(e.top+c)+"px;";this.fire("show",{src:b,
offsetX:a,offsetY:c});return this}},hide:function(){this.elems.detail.style.cssText+=";left:-9999px; top:-9999px;";this.fire("hide");return this},__init:function(){this.fire("beforeInit");var b=this.elems;b.target=this.config.target;b.target.style.cssText+=";position:relative; overflow:hidden;";var a=k.createElement("div");a.className="magnifier_detail_"+this.uuid;a.style.cssText+=";left:-9999px; top:-9999px;";k.body.appendChild(a);b.detail=a;var c=k.createElement("img");c.className="magnifier_loading_"+
this.uuid;c.style.cssText+=";z-index:10;";a.appendChild(c);b.loading=c;c=k.createElement("div");c.className="magnifier_detailLayer_"+this.uuid;c.style.cssText+=";z-index:100;";a.appendChild(c);b.detailLayer=c;a=k.createElement("img");a.className="magnifier_detailImg_"+this.uuid;c.appendChild(a);b.detailImg=a;a=k.createElement("div");a.className="magnifier_layer_"+this.uuid;a.style.cssText+=";left:-9999px; top:-9999px;";b.target.appendChild(a);b.layer=a;f.bindEvt(b.target,"mousemove",function(){var a=
this;return function(b){q._move.call(b.target||b.srcElement,b,a)}}.call(this));f.bindEvt(b.target,"mouseenter",function(){var b=this;return function(a){q._enter.call(a.target||a.srcElement,a,b,b.config)}}.call(this));f.bindEvt(b.target,"mouseleave",function(){var b=this;return function(a){q._leave.call(a.target||a.srcElement,a,b)}}.call(this));try{delete this.init}catch(d){}this.fire("init")},changeTarget:function(a){var c=this.elems.target;this.elems.target=this.config.target=a;this.fire("changeTarget",
{target:a,prevTarget:c});return this},dispose:function(){return this},turn:function(a){a="undefined"===typeof a?"ON":(a+"").toUpperCase()in p?(a+"").toUpperCase():a?"ON":"OFF";this.STATUS=p[a];this.fire("turn",{status:a});return this}});c=function(){var a=[],c;for(c in this)g[this[c].namespace]||a.push(this[c].src);return a}.call({0:{name:"preload",namespace:"Preload",src:"/script/magnifier/preload.js"},1:{name:"CSSRuleOperator",namespace:"CSSRuleOperator",src:"/script/magnifier/cssrule.js"}});c.push(function(){jQuery(function(){f.readyState=
!0;d.browser=jQuery.browser;f.bindEvt=function(a,c,d){jQuery(a).bind(c,d)};f.unbindEvt=function(a,c,d){jQuery(a).unbind(c,d)};d.Preload=g.Preload;d.Rule=g.CSSRuleOperator;n.init()})});d.require.apply(this,c);return f}.call(this,window,document);